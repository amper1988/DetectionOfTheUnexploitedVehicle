package com.belspec.detectionoftheunexploitedvehicle;

import android.content.Intent;
import android.os.Bundle;
import android.support.v7.app.AppCompatActivity;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;

import com.belspec.detectionoftheunexploitedvehicle.Adapters.ImageListAdapter;

public class ControlActivity extends AppCompatActivity implements View.OnClickListener{
    TextView txvName;
    Button btnLogout;
    Button btnDetection;
    Button btnEvacuation;


    @Override
    protected void onPostResume() {
        super.onPostResume();
        if (!UserManager.getInstanse().ismRegistered()){
            logout();
        }
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.control_activity);
        if (UserManager.getInstanse().ismRegistered()){
            initViews();
            initComponent();
        }else{
            logout();
        }


    }

    private void initViews(){
        txvName = (TextView)findViewById(R.id.txvUsername);
        btnLogout = (Button)findViewById(R.id.btnLogout);
        btnDetection = (Button) findViewById(R.id.btnDetection);
        btnEvacuation = (Button) findViewById(R.id.btnEvacuation);
    }

    private void initComponent(){
        btnLogout.setOnClickListener(this);
        btnDetection.setOnClickListener(this);
        btnEvacuation.setOnClickListener(this);
        txvName.setText(UserManager.getInstanse().getmLogin());
    }

    private void logout(){
        UserManager.getInstanse().logout();
        Intent intent = new Intent(this, MainActivity.class);
        startActivity(intent);
        closeActivity();

    }

    private void closeActivity(){
        this.finish();
    }

    @Override
    public void onClick(View view) {

        switch (view.getId()){
            case R.id.btnDetection:
                ImageListAdapter.getInstance().clear();
                getFragmentManager().beginTransaction().replace(R.id.frgmCont, new DetectionFragment()).commit();
                break;
            case R.id.btnLogout:
                logout();
                break;
            case R.id.btnEvacuation:
                ImageListAdapter.getInstance().clear();
                getFragmentManager().beginTransaction().replace(R.id.frgmCont, new FindFragment()).commit();
                break;
        }
    }



}
