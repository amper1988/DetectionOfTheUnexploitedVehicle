package com.belspec.detectionoftheunexploitedvehicle;

import android.content.Intent;
import android.graphics.Bitmap;
import android.net.Uri;
import android.os.Bundle;
import android.os.Environment;
import android.provider.MediaStore;
import android.support.v7.app.AppCompatActivity;
import android.util.Log;
import android.view.View;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.TextView;
import android.widget.Toast;

import com.belspec.detectionoftheunexploitedvehicle.Adapters.ImageListAdapter;
import com.belspec.detectionoftheunexploitedvehicle.Interface.DetectionRegisterListener;
import com.belspec.detectionoftheunexploitedvehicle.Interface.ResponseListener;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Api;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.CreateDetection.Image;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.CreateDetection.Request.CreateDetectionRequestEnvelope;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.CreateDetection.Request.ImageList;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.CreateDetection.Response.CreateDetectionResponseEnvelope;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.Contractor;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.Manufacture;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.Model;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.PoliceDepartment;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.Request.GetDefaultDataRequestEnvelope;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.Model.TakeDefaultData.Response.GetDefaultDataResponseEnvelope;
import com.belspec.detectionoftheunexploitedvehicle.Retrofit.RetrofitService;
import com.belspec.detectionoftheunexploitedvehicle.Utils.Converter;
import com.belspec.detectionoftheunexploitedvehicle.Utils.Encode;

import java.io.File;
import java.util.ArrayList;
import java.util.List;

import retrofit2.Response;

public class ControlActivity extends AppCompatActivity implements View.OnClickListener{
    TextView txvName;
    Button btnLogout;
    Button btnDetection;
    Button btnEvacuation;


    @Override
    protected void onPostResume() {
        super.onPostResume();
        if (!UserManager.getInstanse().ismRegistered()){
            logout();
        }
    }

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.control_activity);
        if (UserManager.getInstanse().ismRegistered()){
            initViews();
            initComponent();
        }else{
            logout();
        }


    }

    private void initViews(){
        txvName = (TextView)findViewById(R.id.txvUsername);
        btnLogout = (Button)findViewById(R.id.btnLogout);
        btnDetection = (Button) findViewById(R.id.btnDetection);
        btnEvacuation = (Button) findViewById(R.id.btnEvacuation);
    }

    private void initComponent(){
        btnLogout.setOnClickListener(this);
        btnDetection.setOnClickListener(this);
        btnEvacuation.setOnClickListener(this);
        txvName.setText(UserManager.getInstanse().getmLogin());
    }

    private void logout(){
        UserManager.getInstanse().logout();
        Intent intent = new Intent(this, MainActivity.class);
        startActivity(intent);
        closeActivity();

    }

    private void closeActivity(){
        this.finish();
    }

    @Override
    public void onClick(View view) {

        switch (view.getId()){
            case R.id.btnDetection:
                getFragmentManager().beginTransaction().replace(R.id.frgmCont, DetectionFragment.getInstance()).commit();
                break;
            case R.id.btnLogout:
                logout();
                break;
            case R.id.btnEvacuation:
                getFragmentManager().beginTransaction().replace(R.id.frgmCont, FindFragment.getInstance()).commit();
                break;
        }
    }



}
